<span style="
color: #b5d3ca;
font-style: italic;
font-family: YouYuan;
top:100px;
display: none;"
id="modified-data-footer">
    <hr></hr>
    <!-- <center>
        最后编辑时间：{{page.last_modified_at | date: "%Y-%m-%dT%H:%M:%SZ" }}
    </center> -->
</span>

<script>
    var git_url="https://api.github.com/repos/{{site.git_repo.user}}/{{site.git_repo.repo}}/";
    var pageURL = decodeURIComponent(window.location.href);
    var footer_time = document.getElementById("modified-data-footer");
    pageURL = "_"+pageURL.substring(pageURL.indexOf("notes/"),pageURL.length).replace("#reloaded","")+".md";
    function enableElement(element){
        element.getAttributeNode("style").value=element.getAttributeNode("style").value.replace("display: none","display: block");
    }
    function footer_enable_func(curCommit){
        var commitDate=curCommit.commit.committer.date;
        var commitAuthor=curCommit.commit.author.name
        if(commitDate)
            {
                enableElement(footer_time);
                footer_time.innerHTML="<hr></hr><center>作者："+commitAuthor+"<br>"+"最后提交时间："+commitDate+"</center>";
            }
    }
    // % if page.last_modified_at %
        // enableElement(footer_time);

    // var script = 'console.log("hello world!")';
    // var workerBlob = new Blob([script], { type: "text/javascript" });
    // var url=URL.createObjectURL(workerBlob);
    var data={git_url,pageURL};
    var worker=new Worker("{{site.baseurl}}/assets/worker.js");
    window.onload = function () {
        worker.postMessage(data);
    }
    window.onbeforeunload = function() {
        worker.terminate();
    }
    worker.onmessage = function (e) {
        footer_enable_func(e.data);
    }
</script>
